<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Upah Bulanan</title>

<style>
body{
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#1e3c72,#2a5298);
  margin:0;
  padding:20px;
}

h2{
  text-align:center;
  color:white;
  margin-bottom:5px;
}

.sub{
  text-align:center;
  color:#ddd;
  margin-bottom:25px;
  font-size:14px;
}

.grid{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
  gap:20px;
}

.card{
  border-radius:15px;
  padding:18px;
  color:white;
  box-shadow:0 8px 20px rgba(0,0,0,0.25);
  transition:0.3s;
  max-height:400px;
  overflow:auto;
}

.card:hover{
  transform:translateY(-5px);
}

.card h3{
  text-align:center;
  margin-bottom:12px;
  font-size:18px;
}

.item{
  display:flex;
  justify-content:space-between;
  font-size:13px;
  padding:6px 0;
  border-bottom:1px solid rgba(255,255,255,0.2);
}

.total{
  margin-top:12px;
  font-weight:bold;
  text-align:right;
  font-size:15px;
}

.grand-total{
  margin-top:25px;
  text-align:center;
  color:white;
  font-size:18px;
  font-weight:bold;
}

/* WARNA PER KARYAWAN */
.soleh{ background: linear-gradient(135deg,#00c9ff,#92fe9d); }
.farhan{ background: linear-gradient(135deg,#ff9966,#ff5e62); }
.yudi{ background: linear-gradient(135deg,#36d1dc,#5b86e5); }
.zaka{ background: linear-gradient(135deg,#f7971e,#ffd200); }

</style>
</head>
<body>

<h2>Dashboard Upah Bulanan</h2>
<div class="sub">Rekap otomatis dari Google Sheet</div>

<div class="grid">

  <div class="card soleh">
    <h3>Soleh</h3>
    <div id="Soleh"></div>
    <div class="total" id="totalSoleh"></div>
  </div>

  <div class="card farhan">
    <h3>Farhan</h3>
    <div id="Farhan"></div>
    <div class="total" id="totalFarhan"></div>
  </div>

  <div class="card yudi">
    <h3>Yudi</h3>
    <div id="Yudi"></div>
    <div class="total" id="totalYudi"></div>
  </div>

  <div class="card zaka">
    <h3>Zaka</h3>
    <div id="Zaka"></div>
    <div class="total" id="totalZaka"></div>
  </div>

</div>

<div class="grand-total" id="grandTotal"></div>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTAP_R50frV13whqx54ctjplc-8xhcN53rHEVk5mkhLeZE283xWnr6TdTBFr-KFymEiaYE_NWgGthpo/pub?gid=716772016&single=true&output=csv";

const upahPerHari = {
  "Soleh": 100000,
  "Farhan": 50000,
  "Yudi": 100000,
  "Zaka": 100000
};

fetch(sheetURL)
.then(res => res.text())
.then(data => {

  const rows = data.split("\n").slice(1);
  const bulanSekarang = new Date().getMonth() + 1;

  let dataHarian = {
    "Soleh": new Set(),
    "Farhan": new Set(),
    "Yudi": new Set(),
    "Zaka": new Set()
  };

  rows.forEach(row => {
    const cols = row.split(",");
    const tanggalStr = cols[0];
    const nama = cols[4];

    if(!tanggalStr || !upahPerHari[nama]) return;

    const parts = tanggalStr.split("/");
    const hari = parts[0];
    const bulan = parseInt(parts[1]);

    if(bulan === bulanSekarang){
      dataHarian[nama].add(hari);
    }
  });

  let grandTotal = 0;

  for(let nama in dataHarian){

    let total = 0;

    Array.from(dataHarian[nama])
      .sort((a,b)=>a-b)
      .forEach(hari => {
        document.getElementById(nama).innerHTML +=
          `<div class="item">
            <span>Tgl ${hari}</span>
            <span>Rp ${upahPerHari[nama].toLocaleString("id-ID")}</span>
          </div>`;
        total += upahPerHari[nama];
      });

    document.getElementById("total"+nama).innerText =
      "Total: Rp " + total.toLocaleString("id-ID");

    grandTotal += total;
  }

  document.getElementById("grandTotal").innerText =
    "TOTAL SEMUA KARYAWAN: Rp " + grandTotal.toLocaleString("id-ID");

});
</script>
